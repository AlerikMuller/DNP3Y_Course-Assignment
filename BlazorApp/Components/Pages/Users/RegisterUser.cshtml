@page "/register"
@inject BlazorApp.Http.IUserService UserService
@inject NavigationManager NavManager

<h3>Register new user</h3>

<div>
    <label>Username:</label>
    <input @bind="userName" />
</div>
<div>
    <label>Password:</label>
    <input type="password" @bind="password" />
</div>

@if (!string.IsNullOrEmpty(errorMessage))
{
    <p style="color:red">@errorMessage</p>
}

<button @onclick="RegisterAsync">Register</button>

@code {
    private string userName = string.Empty;
    private string password = string.Empty;
    private string errorMessage = string.Empty;

    private async Task RegisterAsync()
    {
        errorMessage = string.Empty;
        try
        {
            var dto = new ApiContracts.DTOs.CreateUserDto
            {
                UserName = userName,
                Password = password
            };

            await UserService.AddUserAsync(dto);
            NavManager.NavigateTo("/");
        }
        catch (Exception e)
        {
            errorMessage = e.Message;
        }
    }
}